{% extends "base.html" %}
{% block content %}
  <div class="d-flex justify-content-center align-items-center" style="min-height:90vh;">
    <div class="card p-5 shadow-lg" style="width: 90%; max-width: 900px; background:#fff; border-top:5px solid #343d45;">
      
      <div class="text-center mb-4">
        <h4 style="font-weight:600; color:#343d45;">Results — No Eve vs With Eve</h4>
        <p class="text-muted small">Comparison of keys and Quantum Bit Error Rate (QBER) with and without eavesdropping.</p>
      </div>

      <div class="row text-center">
        <div class="col-md-6">
          <div class="card p-3 mb-3 border-0 shadow-sm" style="background:#f9f9f9;">
            <h5 class="text-success mb-2">No Eve (Ideal)</h5>
            <p><b>Sifted key (Alice):</b> {{ alice_key_no_eve }}</p>
            <p><b>Sifted key (Bob):</b> {{ bob_key_no_eve }}</p>
            <p><b>QBER:</b> {{ qber_no_eve }}%</p>
          </div>
        </div>

        <div class="col-md-6">
          <div class="card p-3 mb-3 border-0 shadow-sm" style="background:#fff5f5;">
            <h5 class="text-danger mb-2">With Eve (Intercepted)</h5>
            <p><b>Sifted key (Alice):</b> {{ alice_key_with_eve }}</p>
            <p><b>Sifted key (Bob):</b> {{ bob_key_with_eve }}</p>
            <p><b>QBER:</b> {{ qber }}%</p>
          </div>
        </div>
      </div>

      <hr style="border-color:#ddd;">

      <h5 class="text-center mb-3" style="color:#343d45;">Per-Qubit Details</h5>
      <div class="table-responsive">
        <table class="table table-sm table-bordered" style="font-size:0.9rem;">
          <thead class="table-dark text-center">
            <tr>
              <th>#</th>
              <th>Alice bit</th>
              <th>Alice basis</th>
              <th>Bob basis</th>
              <th>Bob (with Eve)</th>
              <th>Bob (without Eve)</th>
              <th>Bases match?</th>
              <th>Eve basis (intercepted)</th>
            </tr>
          </thead>
          <tbody class="text-center">
            {% for r in rows %}
              <tr>
                <td>{{ r.index + 1 }}</td>
                <td>{{ r.alice_bit }}</td>
                <td>{{ r.alice_basis }}</td>
                <td>{{ r.bob_basis }}</td>
                <td>{{ r.bob_with_eve }}</td>
                <td>{{ r.bob_no_eve }}</td>
                <td>{% if r.bases_match %}✅{% else %}—{% endif %}</td>
                <td>{% if r.eve_info %}({{ r.eve_info.eve_basis }},{{ r.eve_info.eve_meas }}){% else %}—{% endif %}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="d-flex justify-content-center gap-3 mt-4">
        <a class="btn btn-success px-4 py-2"
           href="{{ url_for('message_send') }}"
           style="background:#343d45; border:none; font-weight:500;">
          Use Key (No Eve) to Send Message →
        </a>
        <a class="btn btn-outline-dark px-4 py-2"
           href="{{ url_for('alice') }}"
           style="border-color:#343d45; color:#343d45; font-weight:500;">
          Restart Simulation
        </a>
      </div>

    </div>
  </div>
{% endblock %}
